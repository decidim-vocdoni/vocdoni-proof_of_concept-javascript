!function(){var t={25816:function(t,e,n){var i={"./decidim/surveys/decidim_surveys.svg":29308};function o(t){var e=r(t);return n(e)}function r(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}o.keys=function(){return Object.keys(i)},o.resolve=r,t.exports=o,o.id=25816},29308:function(t,e,n){"use strict";t.exports=n.p+"media/images/decidim_surveys-5771e3e945ff9473a563.svg"}},e={};function n(i){var o=e[i];if(void 0!==o)return o.exports;var r=e[i]={exports:{}};return t[i](r,r.exports,n),r.exports}n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/decidim-packs/",function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(e,n){for(var i=0;i<n.length;i++){var o=n[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(r=o.key,a=void 0,a=function(e,n){if("object"!==t(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,n||"default");if("object"!==t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(r,"string"),"symbol"===t(a)?a:String(a)),o)}var r,a}var o=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e(this,t),this.wrapperField=n.wrapperField,this.controllerFieldSelector=n.controllerFieldSelector,this.dependentInputSelector=n.dependentInputSelector,this.controllerSelector=this.wrapperField.find(this.controllerFieldSelector),this._bindEvent(),this._run()}var n,o,r;return n=t,(o=[{key:"_run",value:function(){var t=this;this.controllerSelector.each((function(e,n){var i=$(n),o=i.is(":checked");i.parents("div.collection-input").find(t.dependentInputSelector).prop("disabled",!o)}))}},{key:"_bindEvent",value:function(){var t=this;this.controllerSelector.on("change",(function(){t._run()}))}}])&&i(n.prototype,o),r&&i(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(o=i.key,a=void 0,a=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===r(a)?a:String(a)),i)}var o,a}var c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,t),this.wrapperField=e.wrapperField,this._bindEvent(),this._order(),this._normalize()}var e,n,i;return e=t,(n=[{key:"_order",value:function(){var t=$(this.wrapperField).find(".collection-input").length;$(this.wrapperField).find(".collection-input").each((function(e,n){for(var i=$(n).find("input[name$=\\[position\\]]"),o=i.val()?parseInt(i.val(),10):t,r=$(n).next();r.length>0;){var a=r.find("input[name$=\\[position\\]]");o>(a.val()?parseInt(a.val(),10):t)&&r.insertBefore($(n)),r=r.next()}}))}},{key:"_findLastPosition",value:function(){var t=0;return $(this.wrapperField).find(".collection-input").each((function(e,n){var i=$(n).find("input[name$=\\[position\\]]"),o=parseInt(i.val(),10);o>t&&(t=o)})),t}},{key:"_normalize",value:function(){$(this.wrapperField).find(".collection-input .position").each((function(t,e){var n=$(e).parent().find("input[name$=\\[position\\]]");n.val()&&(n.val(t),n.prop("disabled",!1),$(e).html("".concat(t+1,". ")))}))}},{key:"_bindEvent",value:function(){var t=this;$(this.wrapperField).find("input[type=checkbox]").on("change",(function(e){var n=$(e.target).parents("label"),i=n.find(".position"),o=n.find("input[name$=\\[position\\]]"),r=t._findLastPosition();e.target.checked?(o.val(r+1),o.prop("disabled",!1),i.html(r+1)):(o.val(""),o.prop("disabled",!0),i.html("")),t._order(),t._normalize()}))}}])&&l(e.prototype,n),i&&l(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(o=i.key,r=void 0,r=function(t,e){if("object"!==u(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==u(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===u(r)?r:String(r)),i)}var o,r}function f(t,e,n){return e&&d(t.prototype,e),n&&d(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var p=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(this,t),this.wrapperField=e.wrapperField,this.type=e.type,this.conditionQuestion=e.conditionQuestion,this.answerOption=e.answerOption,this.mandatory=e.mandatory,this.value=e.value,this.onFulfilled=e.onFulfilled,this.bindEvent()}return f(t,[{key:"bindEvent",value:function(){this.checkCondition(),this.getInputsToListen().on("change",this.checkCondition.bind(this))}},{key:"getInputValue",value:function(){var t=$(".question[data-question-id='".concat(this.conditionQuestion,"']")),e=t.find("textarea, input[type='text']:not([name$=\\[custom_body\\]])");if(e.length)return e.val();var n=[];return t.find(".radio-button-collection, .check-box-collection").find(".collection-input").each((function(t,e){var i=$(e).find("input[name$=\\[body\\]]");if(i.is(":checked")){var o=$(e).find("input[name$=\\[custom_body\\]]").val(),r=i.val(),a=$(e).find("input[name$=\\[answer_option_id\\]]").val();n.push({id:a,value:r,text:o})}})),n}},{key:"getInputsToListen",value:function(){var t=$(".question[data-question-id='".concat(this.conditionQuestion,"']")),e=t.find("textarea, input[type='text']:not([name$=\\[custom_body\\]])");return e.length?e:t.find(".collection-input").find("input:not([type='hidden'])")}},{key:"checkAnsweredCondition",value:function(t){return"object"!==u(t)?Boolean(t):Boolean(t.some((function(t){return t.value})))}},{key:"checkNotAnsweredCondition",value:function(t){return!this.checkAnsweredCondition(t)}},{key:"checkEqualCondition",value:function(t){var e=this;return!!t.length&&t.some((function(t){return t.id===e.answerOption.toString()}))}},{key:"checkNotEqualCondition",value:function(t){var e=this;return!!t.length&&t.every((function(t){return t.id!==e.answerOption.toString()}))}},{key:"checkMatchCondition",value:function(t){var e=new RegExp(this.value,"i");return"object"!==u(t)?Boolean(t.match(e)):t.some((function(t){return t.text?t.text.match(e):t.value.match(e)}))}},{key:"checkCondition",value:function(){var t=this.getInputValue(),e=!1;switch(this.type){case"answered":e=this.checkAnsweredCondition(t);break;case"not_answered":e=this.checkNotAnsweredCondition(t);break;case"equal":e=this.checkEqualCondition(t);break;case"not_equal":e=this.checkNotEqualCondition(t);break;case"match":e=this.checkMatchCondition(t);break;default:e=!1}this.onFulfilled(e)}}]),t}(),h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(this,t),this.wrapperField=e.wrapperField,this.conditions={},this.showCount=0,this.initializeConditions()}return f(t,[{key:"initializeConditions",value:function(){var t=this;this.wrapperField.find(".display-condition").each((function(e,n){var i=$(n),o=i.data("id");t.conditions[o]={},t.conditions[o]=new p({wrapperField:t.wrapperField,type:i.data("type"),conditionQuestion:i.data("condition"),answerOption:i.data("option"),mandatory:i.data("mandatory"),value:i.data("value"),onFulfilled:function(e){t.onFulfilled(o,e)}})}))}},{key:"mustShow",value:function(){var t=Object.values(this.conditions),e=t.filter((function(t){return t.mandatory})),n=t.filter((function(t){return!t.mandatory}));return e.length?e.every((function(t){return t.fulfilled})):n.some((function(t){return t.fulfilled}))}},{key:"onFulfilled",value:function(t,e){this.conditions[t].fulfilled=e,this.mustShow()?this.showQuestion():this.hideQuestion()}},{key:"showQuestion",value:function(){this.wrapperField.fadeIn(),this.wrapperField.find("input, textarea").prop("disabled",null),this.showCount++}},{key:"hideQuestion",value:function(){this.showCount?this.wrapperField.fadeOut():this.wrapperField.hide(),this.wrapperField.find("input, textarea").prop("disabled","disabled")}}]),t}();function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(o=i.key,r=void 0,r=function(t,e){if("object"!==v(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==v(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===v(r)?r:String(r)),i)}var o,r}var b=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y(this,t),this.wrapperField=e.wrapperField,this.alertElement=e.alertElement,this.controllerFieldSelector=e.controllerFieldSelector,this.controllerCollectionSelector=e.controllerCollectionSelector,this.maxChoices=e.maxChoices,this.controllerSelector=this.wrapperField.find(this.controllerFieldSelector),this._bindEvent(),this._run()}var e,n,i;return e=t,(n=[{key:"_run",value:function(){var t=this,e=this.wrapperField.find(this.controllerCollectionSelector),n=!1;e.each((function(e,i){var o=$(i).find(t.controllerFieldSelector).filter((function(t,e){return $(e).is(":checked")}));n=n||o.length>t.maxChoices})),n?this.alertElement.show():this.alertElement.hide()}},{key:"_bindEvent",value:function(){var t=this;this.controllerSelector.on("change",(function(){t._run()}))}}])&&m(e.prototype,n),i&&m(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();$((function(){$(".radio-button-collection, .check-box-collection").each((function(t,e){var n;n={wrapperField:$(e),controllerFieldSelector:"input[type=radio], input[type=checkbox]",dependentInputSelector:"input[type=text], input[type=hidden]"},new o(n)})),$.unique($(".check-box-collection").parents(".answer")).each((function(t,e){var n,i=$(e).data("max-choices");i&&(n={wrapperField:$(e),controllerFieldSelector:"input[type=checkbox]",controllerCollectionSelector:".check-box-collection",alertElement:$(e).find(".max-choices-alert"),maxChoices:i},new b(n))})),$(".sortable-check-box-collection").each((function(t,e){var n;n={wrapperField:$(e)},new c(n)})),$(".answer-questionnaire .question[data-conditioned='true']").each((function(t,e){var n;n={wrapperField:$(e)},new h(n)}));var t=$("form.answer-questionnaire");if(t.length>0){t.find("input, textarea, select").on("change",(function(){t.data("changed",!0)}));var e=t.data("safe-path").split("?")[0];$(document).on("click","a",(function(t){window.exitUrl=t.currentTarget.href})),$(document).on("submit","form",(function(t){window.exitUrl=t.currentTarget.action})),window.addEventListener("beforeunload",(function(n){var i=window.exitUrl,o=t.data("changed");window.exitUrl=null,!o||i&&i.includes(e)||(n.returnValue=!0)}))}})),n(25816)}()}();
//# sourceMappingURL=decidim_forms-c8032f77db7a68516ce7.js.map