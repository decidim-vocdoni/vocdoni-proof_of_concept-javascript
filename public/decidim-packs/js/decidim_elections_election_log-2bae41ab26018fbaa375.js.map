{"version":3,"file":"js/decidim_elections_election_log-2bae41ab26018fbaa375.js","mappings":"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","sources":["webpack://decidim-development-app/webpack/runtime/chunk loaded","webpack://decidim-development-app/./node_modules/@decidim/decidim-bulletin_board/src/client/message-identifier.js","webpack://decidim-development-app/./node_modules/@decidim/decidim-bulletin_board/src/client/message-parser.js","webpack://decidim-development-app/./node_modules/@decidim/decidim-bulletin_board/src/utils.js","webpack://decidim-development-app/../decidim-elections/app/packs/src/decidim/elections/election_log.js","webpack://decidim-development-app/./node_modules/node-jose/lib/index.js","webpack://decidim-development-app/webpack/bootstrap","webpack://decidim-development-app/webpack/runtime/compat get default export","webpack://decidim-development-app/webpack/runtime/define property getters","webpack://decidim-development-app/webpack/runtime/global","webpack://decidim-development-app/webpack/runtime/hasOwnProperty shorthand","webpack://decidim-development-app/webpack/runtime/node module decorator","webpack://decidim-development-app/webpack/runtime/jsonp chunk loading","webpack://decidim-development-app/webpack/startup"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","export const AUTHORITY_TYPE = \"a\";\nexport const BULLETIN_BOARD_TYPE = \"b\";\nexport const VOTER_TYPE = \"v\";\nexport const TRUSTEE_TYPE = \"t\";\nexport const VALID_TYPES = [\n  AUTHORITY_TYPE,\n  BULLETIN_BOARD_TYPE,\n  VOTER_TYPE,\n  TRUSTEE_TYPE,\n];\n\n/**\n * This is a class that handles message id strings.\n */\nexport class MessageIdentifier {\n  /**\n   * Parses a message id string into a JS object.\n   *\n   * @param {String} messageId - A string with a message id.\n   * @returns {Object} - An object with the message id values.\n   */\n  static parse(messageId) {\n    const [elements, author] = messageId.split(\"+\");\n    const [authority, electionId, type, subtype] = elements.split(\".\", 4);\n    const [authorType, authorId] = author.split(\".\", 2);\n    const dotSubtype = subtype ? `.${subtype}` : \"\";\n\n    if (!VALID_TYPES.includes(authorType)) {\n      throw new Error(\"Invalid message identifier format\");\n    }\n\n    return {\n      electionId: `${authority}.${electionId}`,\n      type,\n      subtype,\n      typeSubtype: `${type}${dotSubtype}`,\n      author: {\n        type: authorType,\n        id: authorId,\n      },\n    };\n  }\n\n  static format(electionId, typeSubtype, authorType, authorId) {\n    return `${electionId}.${typeSubtype}+${authorType}.${authorId}`;\n  }\n}\n","import { JWS, JWK } from \"node-jose\";\nimport {\n  MessageIdentifier,\n  AUTHORITY_TYPE,\n  BULLETIN_BOARD_TYPE,\n  TRUSTEE_TYPE,\n} from \"./message-identifier\";\nimport { samePublicKeys } from \"../utils\";\n\n/**\n * Verify and parses JWT tokens.\n */\nexport class MessageParser {\n  /**\n   * Initializes the class with the given params.\n   *\n   * @constructor\n   * @param {Object} params - An object that contains the initialization params.\n   * - {String} authorityPublicKeyJSON - The public key of the authority\n   */\n  constructor({ authorityPublicKeyJSON }) {\n    this.authorityPublicKeyJSON = authorityPublicKeyJSON;\n    this.authorityPublicKey = JWK.asKey(authorityPublicKeyJSON, \"json\");\n    this.keys = null;\n  }\n\n  /**\n   * Parses the given token only if it can be verified.\n   *\n   * @param {String} token - A JWT token.\n   * @returns {Promise<Object>} - The payload included in the token.\n   * @throws An error is thrown if the payload is not a valid JSON or the token\n   *         cannot be verified.\n   */\n  async parse({ messageId, signedData }) {\n    const messageIdentifier = MessageIdentifier.parse(messageId);\n    const senderKey = await (this.keys\n      ? this.keys[messageIdentifier.author.type][messageIdentifier.author.id]\n      : this.authorityPublicKey);\n\n    if (!signedData) {\n      return { messageIdentifier, decodedData: null };\n    }\n\n    const result = await JWS.createVerify(senderKey).verify(signedData, {\n      algorithms: [\"RS256\"],\n    });\n\n    const decodedData = JSON.parse(\n      new TextDecoder(\"utf-8\").decode(result.payload)\n    );\n\n    if (!this.keys) {\n      this.keys = await this.parseCreateElection(decodedData);\n    }\n\n    return { messageIdentifier, decodedData };\n  }\n\n  /* eslint-disable camelcase */\n  async parseCreateElection({ authority, bulletin_board, trustees }) {\n    if (!samePublicKeys(authority.public_key, this.authorityPublicKeyJSON)) {\n      throw new Error(\n        \"The authority public key doesn't match the election's authority public key.\"\n      );\n    }\n\n    const result = {\n      [AUTHORITY_TYPE]: { [authority.slug]: this.authorityPublicKey },\n      [BULLETIN_BOARD_TYPE]: {},\n      [TRUSTEE_TYPE]: {},\n    };\n\n    const promises = [];\n    promises.push(\n      this.loadKey(bulletin_board).then((key) => {\n        result[BULLETIN_BOARD_TYPE][bulletin_board.slug] = key;\n      })\n    );\n    for (const trustee of trustees) {\n      promises.push(\n        this.loadKey(trustee).then((key) => {\n          result[TRUSTEE_TYPE][trustee.slug] = key;\n        })\n      );\n    }\n\n    await Promise.all(promises);\n\n    return result;\n  }\n  /* eslint-enable camelcase */\n\n  loadKey(client) {\n    return JWK.asKey(client.public_key, \"json\");\n  }\n}\n","export function samePublicKeys(key1, key2) {\n  const jwk1 = typeof key1 === \"string\" ? JSON.parse(key1) : key1;\n  const jwk2 = typeof key2 === \"string\" ? JSON.parse(key2) : key2;\n\n  if (jwk1 && jwk2) {\n    const { n: n1, e: e1, kty: kty1 } = jwk1;\n    const { n: n2, e: e2, kty: kty2 } = jwk2;\n\n    return n1 === n2 && e1 === e2 && kty1 === kty2;\n  }\n  return false;\n}\n","/**\n * This file is responsible to get LogEntries\n * for an election for the election log.\n */\nimport { Client, MessageParser } from \"@decidim/decidim-bulletin_board\";\n\n$(async () => {\n  // UI Elements\n  const $electionLog = $(\".election-log\");\n  const $createElectionStep = $electionLog.find(\"#create-election-step\");\n  const $keyCeremonyStep = $electionLog.find(\"#key-ceremony-step\");\n  const $voteStep = $electionLog.find(\"#vote-step\");\n  const $tallyStep = $electionLog.find(\"#tally-step\");\n  const $resultStep = $electionLog.find(\"#results-step\");\n\n  // Data\n  const authorityPublicKeyJSON = JSON.stringify(\n    $electionLog.data(\"authorityPublicKey\")\n  );\n  const bulletinBoardClient = new Client({\n    apiEndpointUrl: $electionLog.data(\"apiEndpointUrl\")\n  });\n  const electionUniqueId = `${$electionLog.data(\n    \"authoritySlug\"\n  )}.${$electionLog.data(\"electionId\")}`;\n  const parser = new MessageParser({ authorityPublicKeyJSON });\n  const logEntries = await bulletinBoardClient.getElectionLogEntries({\n    electionUniqueId: electionUniqueId,\n    types: [\n      \"create_election\",\n      \"start_key_ceremony\",\n      \"end_key_ceremony\",\n      \"start_vote\",\n      \"end_vote\",\n      \"start_tally\",\n      \"end_tally\",\n      \"publish_results\"\n    ]\n  });\n\n  // Functions to be used for each step\n\n  // adds the `iat` of the message to the UI\n  const setMessageTime = async (logEntryStep, uiStep) => {\n    if (!logEntryStep.signedData) {\n      uiStep.find(\".time\").html(\"\");\n      return;\n    }\n\n    const parsedData = await parser.parse(logEntryStep);\n    const messageTime = new Date(parsedData.decodedData.iat * 1000);\n    const year = messageTime.toDateString();\n    const time = messageTime.toLocaleTimeString();\n\n    uiStep.find(\".time\").html(`${year} ${time}`);\n  };\n\n  // adds the chained Hash of the message to the UI\n  const addChainedHash = (logEntryStep, uiStep) => {\n    uiStep.find(\".card__footer--transparent\").removeClass(\"hide\");\n    uiStep.find(\".chained-hash\").html(logEntryStep.chainedHash);\n  };\n\n  // finds the logEntry for each step\n  const getLogEntryByMessageId = (step) => {\n    return logEntries.find((logEntry) => logEntry.messageId.includes(step));\n  };\n\n  // CREATE ELECTION STEP\n  const createElectionLogEntry = getLogEntryByMessageId(\"create_election\");\n  if (createElectionLogEntry) {\n    $createElectionStep.find(\".no-election-created\").addClass(\"hide\");\n    $createElectionStep.find(\".election-created\").removeClass(\"hide\");\n\n    await setMessageTime(createElectionLogEntry, $createElectionStep);\n\n    addChainedHash(createElectionLogEntry, $createElectionStep);\n  }\n\n  // KEY CEREMONY STEP\n  const startKeyCeremonyLogEntry = getLogEntryByMessageId(\"start_key_ceremony\");\n  const endKeyCeremonyLogEntry = getLogEntryByMessageId(\"end_key_ceremony\");\n\n  if (startKeyCeremonyLogEntry && !endKeyCeremonyLogEntry) {\n    $keyCeremonyStep.find(\".key-ceremony-not-started\").addClass(\"hide\");\n    $keyCeremonyStep.find(\".card__text\").removeClass(\"hide\");\n\n    await setMessageTime(startKeyCeremonyLogEntry, $keyCeremonyStep);\n\n    $keyCeremonyStep.find(\".key-ceremony-started\").removeClass(\"hide\");\n    addChainedHash(startKeyCeremonyLogEntry, $keyCeremonyStep);\n  } else if (endKeyCeremonyLogEntry) {\n    $keyCeremonyStep.find(\".key-ceremony-not-started\").addClass(\"hide\");\n    $keyCeremonyStep.find(\".card__text\").removeClass(\"hide\");\n\n    await setMessageTime(endKeyCeremonyLogEntry, $keyCeremonyStep);\n\n    $keyCeremonyStep.find(\".key-ceremony-started\").addClass(\"hide\");\n    $keyCeremonyStep.find(\".key-ceremony-completed\").removeClass(\"hide\");\n    addChainedHash(endKeyCeremonyLogEntry, $keyCeremonyStep);\n  }\n\n  // VOTING STEP\n  const startVoteLogEntry = getLogEntryByMessageId(\"start_vote\");\n  const endVoteLogEntry = getLogEntryByMessageId(\"end_vote\");\n\n  if (startVoteLogEntry && !endVoteLogEntry) {\n    $voteStep.find(\".vote-not-started\").addClass(\"hide\");\n    $voteStep.find(\".card__text\").removeClass(\"hide\");\n\n    await setMessageTime(startVoteLogEntry, $voteStep);\n\n    $voteStep.find(\".vote-started\").removeClass(\"hide\");\n    addChainedHash(startVoteLogEntry, $voteStep);\n  } else if (endVoteLogEntry) {\n    $voteStep.find(\".vote-not-started\").addClass(\"hide\");\n    $voteStep.find(\".card__text\").removeClass(\"hide\");\n\n    await setMessageTime(endVoteLogEntry, $voteStep);\n\n    $voteStep.find(\".vote-started\").addClass(\"hide\");\n    $voteStep.find(\".vote-completed\").removeClass(\"hide\");\n    addChainedHash(endVoteLogEntry, $voteStep);\n  }\n\n  // TALLY STEP\n  const startTallyLogEntry = getLogEntryByMessageId(\"start_tally\");\n  const endTallyLogEntry = getLogEntryByMessageId(\"end_tally\");\n\n  if (startTallyLogEntry && !endTallyLogEntry) {\n    $tallyStep.find(\".tally-not-started\").addClass(\"hide\");\n    $tallyStep.find(\".card__text\").removeClass(\"hide\");\n\n    await setMessageTime(startTallyLogEntry, $tallyStep);\n\n    $tallyStep.find(\".tally-started\").removeClass(\"hide\");\n    addChainedHash(startTallyLogEntry, $tallyStep);\n  } else if (endTallyLogEntry) {\n    $tallyStep.find(\".tally-not-started\").addClass(\"hide\");\n    $tallyStep.find(\".card__text\").removeClass(\"hide\");\n\n    await setMessageTime(endTallyLogEntry, $tallyStep);\n\n    $tallyStep.find(\".tally-started\").addClass(\"hide\");\n    $tallyStep.find(\".tally-completed\").removeClass(\"hide\");\n    addChainedHash(endTallyLogEntry, $tallyStep);\n  }\n\n  // RESULTS STEP\n  const resultsLogEntry = getLogEntryByMessageId(\"publish_results\");\n\n  if (resultsLogEntry) {\n    $resultStep.find(\".results-not-published\").addClass(\"hide\");\n    $resultStep.find(\".card__text\").removeClass(\"hide\");\n\n    await setMessageTime(resultsLogEntry, $resultStep);\n\n    $resultStep.find(\".results-published\").removeClass(\"hide\");\n    addChainedHash(resultsLogEntry, $resultStep);\n  }\n});\n","/*!\n * index.js - Main Entry Point\n *\n * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.\n */\n\"use strict\";\n\nif (typeof Promise === \"undefined\") {\n  require(\"es6-promise\").polyfill();\n}\n\nif (typeof Buffer === \"undefined\") {\n  (global || window).Buffer = require(\"buffer\").Buffer;\n}\n\nif (typeof process === \"undefined\") {\n  (global || window).process = require(\"process\");\n}\n\nif (!process.version) {\n  process.version = \"\";\n}\n\nvar JWS = require(\"./jws\");\n\nmodule.exports = {\n  JWA: require(\"./algorithms\"),\n  JWE: require(\"./jwe\"),\n  JWK: require(\"./jwk\"),\n  JWS: JWS,\n  util: require(\"./util\"),\n  parse: require(\"./parse\"),\n  canYouSee: JWS.createVerify\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","__webpack_require__.nmd = function(module) {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t2661: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkdecidim_development_app\"] = self[\"webpackChunkdecidim_development_app\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [9098,8276,3229], function() { return __webpack_require__(56633); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["deferred","AUTHORITY_TYPE","BULLETIN_BOARD_TYPE","TRUSTEE_TYPE","VALID_TYPES","MessageIdentifier","static","messageId","elements","author","split","authority","electionId","type","subtype","authorType","authorId","dotSubtype","includes","Error","typeSubtype","id","MessageParser","constructor","authorityPublicKeyJSON","this","authorityPublicKey","JWK","keys","async","signedData","messageIdentifier","senderKey","decodedData","result","JWS","verify","algorithms","JSON","parse","TextDecoder","decode","payload","parseCreateElection","bulletin_board","trustees","public_key","slug","promises","push","loadKey","then","key","trustee","Promise","all","client","samePublicKeys","key1","key2","jwk1","jwk2","n","n1","e","e1","kty","kty1","n2","e2","kty2","$","$electionLog","$createElectionStep","find","$keyCeremonyStep","$voteStep","$tallyStep","$resultStep","stringify","data","bulletinBoardClient","Client","apiEndpointUrl","electionUniqueId","parser","getElectionLogEntries","types","logEntries","setMessageTime","logEntryStep","uiStep","html","parsedData","messageTime","Date","iat","year","toDateString","time","toLocaleTimeString","addChainedHash","removeClass","chainedHash","createElectionLogEntry","getLogEntryByMessageId","step","logEntry","_context2","addClass","startKeyCeremonyLogEntry","endKeyCeremonyLogEntry","startVoteLogEntry","endVoteLogEntry","startTallyLogEntry","endTallyLogEntry","resultsLogEntry","Buffer","g","window","process","version","module","exports","JWA","JWE","util","canYouSee","createVerify","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","loaded","__webpack_modules__","call","m","O","chunkIds","fn","priority","notFulfilled","Infinity","i","length","fulfilled","j","Object","every","splice","r","getter","__esModule","d","a","definition","o","defineProperty","enumerable","get","globalThis","Function","obj","prop","prototype","hasOwnProperty","nmd","paths","children","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","self","forEach","bind","__webpack_exports__"],"sourceRoot":""}