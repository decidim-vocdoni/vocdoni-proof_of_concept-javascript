{"version":3,"file":"js/decidim_elections_trustee_trustee_zone-fe5bbe606750cf977529.js","mappings":"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","sources":["webpack://decidim-development-app/webpack/runtime/chunk loaded","webpack://decidim-development-app/./node_modules/@decidim/decidim-bulletin_board/src/trustee/identification_keys.js","webpack://decidim-development-app/../decidim-elections/app/packs/src/decidim/elections/trustee/trustee_zone.js","webpack://decidim-development-app/webpack/bootstrap","webpack://decidim-development-app/webpack/runtime/define property getters","webpack://decidim-development-app/webpack/runtime/global","webpack://decidim-development-app/webpack/runtime/hasOwnProperty shorthand","webpack://decidim-development-app/webpack/runtime/node module decorator","webpack://decidim-development-app/webpack/runtime/jsonp chunk loading","webpack://decidim-development-app/webpack/startup"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","/**\n * IdentificationKeys component.\n */\n\nimport { samePublicKeys } from \"../utils\";\n\nexport class IdentificationKeys {\n  constructor(trusteeUniqueId, storedPublicKey) {\n    this.format = \"jwk\";\n    this.algorithm = {\n      name: \"RSASSA-PKCS1-v1_5\",\n      modulusLength: 4096,\n      publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n      hash: { name: \"SHA-256\" },\n    };\n    this.usages = [\"sign\"];\n    this.publicKeyAttrs = [\"alg\", \"e\", \"kty\", \"n\"];\n    this.jwtHeader = this._encode64(\n      JSON.stringify({ alg: \"RS256\", typ: \"JWT\" })\n    );\n\n    this.trusteeUniqueId = trusteeUniqueId;\n    this.privateKey = null;\n    this.publicKey = null;\n    this.storedPublicKey = JSON.parse(storedPublicKey || null);\n    this.keyIdentifier = `${trusteeUniqueId}-private-key`;\n    this.browserSupport = this._checkBrowserSupport();\n    this.textEncoder = new TextEncoder(\"utf-8\");\n\n    this.dbName = \"identification_keys\";\n    this.dbVersion = 1;\n    this.presentPromise = this._read();\n  }\n\n  present(then) {\n    this.presentPromise.then(() => {\n      if (this._matchesStoredPublicKey(this.publicKey)) {\n        then(this.browserSupport && this.privateKey !== null);\n      } else {\n        this.reset().then(then(false));\n      }\n    });\n  }\n\n  async generate() {\n    if (!this.browserSupport || this.storedPublicKey) {\n      return false;\n    }\n\n    return new Promise((resolve, reject) => {\n      try {\n        return this.crypto.subtle\n          .generateKey(this.algorithm, true, this.usages)\n          .then((keyPair) => {\n            return this.crypto.subtle\n              .exportKey(this.format, keyPair.privateKey)\n              .then((jwk) => {\n                this.publicKey = this._publicKeyFromPrivateKey(jwk);\n                const element = document.createElement(\"a\");\n                element.setAttribute(\n                  \"href\",\n                  `data:text/plain;charset=utf-8,${encodeURIComponent(\n                    JSON.stringify(jwk)\n                  )}`\n                );\n                element.setAttribute(\"download\", `${this.keyIdentifier}.jwk`);\n                element.style.display = \"none\";\n                document.body.appendChild(element);\n                element.click();\n                document.body.removeChild(element);\n                return resolve();\n              })\n              .catch(this._handleErrors);\n          });\n      } catch (error) {\n        return reject(error);\n      }\n    });\n  }\n\n  async upload(event) {\n    if (!this.browserSupport || this.privateKey !== null) {\n      return false;\n    }\n\n    return new Promise((resolve, reject) => {\n      if (event) {\n        this.onUploadInputChange(event, resolve, reject);\n      } else {\n        const element = document.createElement(\"input\");\n        element.setAttribute(\"type\", \"file\");\n        element.setAttribute(\"accept\", \".jwk\");\n        element.style.display = \"none\";\n        document.body.appendChild(element);\n\n        element.addEventListener(\"change\", (event) => {\n          document.body.removeChild(element);\n          this.onUploadInputChange(event, resolve, reject);\n        });\n        element.click();\n      }\n    });\n  }\n\n  onUploadInputChange(event, resolve, reject) {\n    const reader = new FileReader();\n    reader.readAsText(event.target.files[0]);\n    reader.onload = (readEvent) => {\n      let jwk = \"\";\n      try {\n        jwk = JSON.parse(readEvent.target.result);\n      } catch (error) {\n        return reject(\"invalid_format\");\n      }\n\n      return this.crypto.subtle\n        .importKey(this.format, jwk, this.algorithm, false, this.usages)\n        .then((privateKey) => {\n          const uploadedPublicKey = this._publicKeyFromPrivateKey(jwk);\n          if (this._matchesStoredPublicKey(uploadedPublicKey)) {\n            this.publicKey = uploadedPublicKey;\n            this.privateKey = privateKey;\n            this._save()\n              .then(() => resolve(true))\n              .catch(() => {\n                reject(\"could not be saved\");\n              });\n          } else {\n            reject(\"invalid_public_key\");\n          }\n        })\n        .catch(() => {\n          reject(\"invalid_key\");\n        });\n    };\n  }\n\n  reset() {\n    this.privateKey = this.publicKey = null;\n    return this._clear();\n  }\n\n  async sign(payload) {\n    if (!this.browserSupport || this.privateKey === null) {\n      return false;\n    }\n\n    const data = `${this.jwtHeader}.${this._encode64(JSON.stringify(payload))}`;\n    const signature = await this.crypto.subtle.sign(\n      this.algorithm,\n      this.privateKey,\n      this.textEncoder.encode(data)\n    );\n    return `${data}.${btoa(\n      Reflect.apply(String.fromCharCode, null, new Uint8Array(signature))\n    )\n      .replace(/[=]/g, \"\")\n      .replace(/\\+/g, \"-\")\n      .replace(/\\//g, \"_\")}`;\n  }\n\n  _checkBrowserSupport() {\n    this.indexedDB =\n      window.indexedDB ||\n      window.mozIndexedDB ||\n      window.webkitIndexedDB ||\n      window.msIndexedDB;\n    this.crypto = window.crypto || window.msCrypto;\n    return window.indexedDB && window.crypto;\n  }\n\n  _handleErrors(error) {\n    throw error;\n  }\n\n  _publicKeyFromPrivateKey(jwk) {\n    return Object.keys(jwk)\n      .filter((key) => this.publicKeyAttrs.includes(key))\n      .reduce((obj, key) => {\n        obj[key] = jwk[key];\n        return obj;\n      }, {});\n  }\n\n  _matchesStoredPublicKey(publicKey) {\n    return samePublicKeys(publicKey, this.storedPublicKey);\n  }\n\n  _encode64(payload) {\n    return btoa(unescape(encodeURIComponent(payload)))\n      .replace(/[=]/g, \"\")\n      .replace(/\\+/g, \"-\")\n      .replace(/\\//g, \"_\");\n  }\n\n  async _read() {\n    return this._useDb(\"readonly\", (store) => {\n      store.get(this.keyIdentifier).onsuccess = (event) => {\n        if (event.target.result) {\n          this.privateKey = event.target.result.privateKey;\n          this.publicKey = event.target.result.publicKey;\n        }\n      };\n    });\n  }\n\n  async _save() {\n    return this._useDb(\"readwrite\", (store) => {\n      store.add(\n        {\n          privateKey: this.privateKey,\n          publicKey: this.publicKey,\n        },\n        this.keyIdentifier\n      );\n    });\n  }\n\n  async _clear() {\n    return this._useDb(\"readwrite\", (store) => {\n      store.delete(this.keyIdentifier);\n    });\n  }\n\n  async _useDb(mode, operation) {\n    return new Promise((resolve, reject) => {\n      let db = null;\n      const dbReq = this.indexedDB.open(this.dbName, this.dbVersion);\n\n      dbReq.onerror = (error) => {\n        db = null;\n        reject(error);\n      };\n\n      dbReq.onupgradeneeded = () => {\n        db = dbReq.result;\n        db.createObjectStore(\"IdentificationKeys\");\n      };\n\n      dbReq.onsuccess = () => {\n        db = dbReq.result;\n        const tx = db.transaction([\"IdentificationKeys\"], mode);\n\n        operation(tx.objectStore(\"IdentificationKeys\"));\n\n        tx.oncomplete = () => {\n          db.close();\n          resolve();\n        };\n      };\n    });\n  }\n}\n","/* eslint-disable require-jsdoc, no-alert, func-style */\n\nimport { IdentificationKeys } from \"@decidim/decidim-bulletin_board\";\n\n$(() => {\n  function identificationKeys() {\n    const $form = $(\".trustee_zone form\");\n    const $trusteeSlug = $(\"#trustee_slug\", $form);\n    const $trusteePublicKey = $(\"#trustee_public_key\", $form);\n\n    window.trusteeIdentificationKeys = new IdentificationKeys(\n      $trusteeSlug.val(),\n      $trusteePublicKey.val()\n    );\n    if (!window.trusteeIdentificationKeys.browserSupport) {\n      $(\"#not_supported_browser\").addClass(\"visible\");\n      return;\n    }\n\n    const $submit = $(\"#submit_identification_keys\");\n    const $generate = $(\"#generate_identification_keys\");\n    const $upload = $(\"#upload_identification_keys\");\n\n    $(\"button\", $generate).on(\"click\", () => {\n      window.trusteeIdentificationKeys.\n        generate().\n        then(() => {\n          $trusteePublicKey.val(\n            JSON.stringify(window.trusteeIdentificationKeys.publicKey)\n          );\n          $submit.addClass(\"visible\");\n        }).\n        catch(() => {\n          alert($generate.data(\"error\"));\n        });\n    });\n\n    $(\"button.hollow\", $submit).click(() => {\n      $trusteePublicKey.val(\"\");\n      $submit.removeClass(\"visible\");\n    });\n\n    $(\"button\", $upload).click(() => {\n      window.trusteeIdentificationKeys.\n        upload().\n        then(() => {\n          $upload.addClass(\"hide\");\n        }).\n        catch((errorMessage) => {\n          alert($upload.data(errorMessage));\n        });\n    });\n\n    window.trusteeIdentificationKeys.present((result) => {\n      $upload.toggleClass(\"hide\", result);\n    });\n  }\n\n  $(document).ready(() => {\n    identificationKeys();\n  });\n});\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","__webpack_require__.nmd = function(module) {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t568: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkdecidim_development_app\"] = self[\"webpackChunkdecidim_development_app\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [9098,4486], function() { return __webpack_require__(84780); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["deferred","IdentificationKeys","constructor","trusteeUniqueId","storedPublicKey","this","format","algorithm","name","modulusLength","publicExponent","Uint8Array","hash","usages","publicKeyAttrs","jwtHeader","_encode64","JSON","stringify","alg","typ","privateKey","publicKey","parse","keyIdentifier","browserSupport","_checkBrowserSupport","textEncoder","TextEncoder","dbName","dbVersion","presentPromise","_read","present","then","_matchesStoredPublicKey","reset","async","Promise","resolve","reject","crypto","subtle","generateKey","keyPair","exportKey","jwk","_publicKeyFromPrivateKey","element","document","createElement","setAttribute","encodeURIComponent","style","display","body","appendChild","click","removeChild","catch","_handleErrors","error","event","onUploadInputChange","addEventListener","reader","FileReader","readAsText","target","files","onload","readEvent","result","importKey","uploadedPublicKey","_save","_clear","payload","data","signature","sign","encode","btoa","Reflect","apply","String","fromCharCode","replace","indexedDB","window","mozIndexedDB","webkitIndexedDB","msIndexedDB","msCrypto","Object","keys","filter","key","includes","reduce","obj","unescape","_useDb","store","get","onsuccess","add","delete","mode","operation","db","dbReq","open","onerror","onupgradeneeded","createObjectStore","tx","transaction","objectStore","oncomplete","close","$","ready","$form","$trusteeSlug","$trusteePublicKey","trusteeIdentificationKeys","val","$submit","$generate","$upload","on","generate","addClass","alert","removeClass","upload","errorMessage","toggleClass","identificationKeys","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","id","loaded","__webpack_modules__","call","m","O","chunkIds","fn","priority","notFulfilled","Infinity","i","length","fulfilled","j","every","splice","r","d","definition","o","defineProperty","enumerable","g","globalThis","Function","e","prop","prototype","hasOwnProperty","nmd","paths","children","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","self","forEach","bind","push","__webpack_exports__"],"sourceRoot":""}